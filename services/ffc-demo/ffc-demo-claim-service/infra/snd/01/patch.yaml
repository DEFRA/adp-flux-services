apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ffc-demo-claim-service-infra
  namespace: flux-config
spec:
  values:
    namespace: ${TEAM_NAMESPACE}
    teamName: ${TEAM_NAME}
    subscriptionId: ${SUBSCRIPTION_ID}
    serviceBusResourceGroupName: ${SERVICES_INFRA_RG}
    serviceBusNamespaceName: ${SHARED_SERVICEBUS_NAME}
    postgresResourceGroupName: ${DATABASE_SERVER_RG}
    postgresServerName: ${SHARED_POSTGRES_SERVER_01}
    clusterOIDCIssuerUrl: ${CLUSTER_OIDC_ISSUER_URL}
    teamResourceGroupName: ${TEAM_RG}
    teamMIPrefix: ${TEAM_MI_PREFIX}
    serviceName: ${SERVICE_NAME}
    keyVaultResourceGroupName: ${SERVICES_INFRA_RG}
    keyVaultName: SNDADPINFVT1401
    workloadIdentity:
      federatedCreds:
        - namespace: ${TEAM_NAMESPACE}
          serviceAccountName: ${SERVICE_NAME}
        - namespace: 'app-config-service'
          serviceAccountName: 'az-appconfig-k8s-provider'
    commontags:
      Environment: ${ENVIRONMENT}
      ServiceCode: ${SERVICE_CODE}
      ServiceName: ${SERVICE_NAME}
      ServiceType: "Dedicated"
      kubernetes_cluster: ${CLUSTER_NAME}
      kubernetes_namespace: ${TEAM_NAMESPACE}
      kubernetes_label_ServiceCode: ${SERVICE_CODE}
        